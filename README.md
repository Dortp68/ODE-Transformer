# ODE-Transformer
ODE neural network, based on encoder-decoder architecture and Autocorrelation attention mechanism
–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —à–∞–≥. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤ —Ä–∞–º–∫–∞—Ö –º–∞–≥–∏—Å—Ç—Ä—Å–∫–æ–π –≤—ã–ø—É—Å–∫–Ω–æ–π –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã.
–ü–æ–¥ —Å–µ—Ç—è–º–∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–º–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è ODE Net(https://arxiv.org/abs/1806.07366) –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –∏–¥–µ–∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –∏ –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã—Ö –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π. –í –¥–∞–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç 
—Å–ª–æ—è –∫ —Å–ª–æ—é –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å–ª–æ–∂–Ω–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –µ—ë —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

$‚Ñé_{ùë°+1} = ‚Ñé_{ùë°} + ùëì(‚Ñé_{ùë°}, ùúÉ_{ùë°})$

–í –ø—Ä–µ–¥–µ–ª–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è (ODE), –∫–æ—Ç–æ—Ä–æ–µ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É–µ—Ç—Å—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç—å—é:

$\frac{ùëë‚Ñé(ùë°)}{ùëëùë°} = ùëì(‚Ñé(ùë°),ùë°, ùúÉ)$

–°–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è ‚Ñé(ùë°) –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ü–µ–Ω–µ–Ω—ã –≤ –Ω—É–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –ø—É—Ç–µ–º –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ ODE –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞ –¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º (–≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ –Ω–µ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–º) —à–∞–≥–æ–º –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ:

![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202024-07-16%20134220.png)

–ù–∞ –≤—Ö–æ–¥ –º–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ (—Ü–µ–ª–µ–≤–∞—è + –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ). –ù–∞ –≤—ã—Ö–æ–¥–µ - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —à–∞–≥–∏. –ü—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å —Å—É—â–µ—Å–≤—Ç—É—é—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —à–∞–≥–∏: [1, 1.5, 2, 2.5, 3].

# –ê—Ä–∏—Ö–µ—Ç–∫—É—Ç—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –º–æ–µ–¥–ª–∏:

![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202024-07-16%20143843.png)

–ú–æ–¥–µ–ª—å –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Encoder-Decoder. –í –∫–∞—á–µ—Å—Ç–≤–µ Encoder —á–∞—Å—Ç–∏ –≤—ã—Å—Ç—é—Ç: –ú–æ–¥—É–ª—å [Autocorrelation-attention](https://github.com/thuml/Autoformer) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –æ—Ü–µ–Ω–∫–∏ –∏—Ö –≤–ª–∏—è–Ω–∏—è –Ω–∞ —Ü–µ–ª–µ–≤—É—é; –ú–æ–¥—É–ª—å ODE-LSTM (—Ä–µ–∫–∫—É—Ä–µ–Ω—Ç–Ω–∞—è —Å–µ—Ç—å, —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–π –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é ODE) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Ä—è–¥–∞. Decoder - ODEnet –≥–¥–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞–ø–ø—Ä–æ–∫–∏—Å–∏—Ä—É—é—â–µ–π nn –≤—ã—Å—Ç—É–ø–∞–µ—Ç LSTM.

![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/arch.png)
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ```pip install -r requirements.txt```

# –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
```python two_ode_selfatt.py -d datasetname```

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞ 4 –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö:
* SML2010
* Electricity
* Electricity Transformer Temperature

–í—Å–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ raw_data. –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ RMSE –∏ MAE. –ê—Ä—Ö–∏—Ç–∏–∫—Ç—É—Ä—ã —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∞—Å—å –º–æ–¥–µ–ª—å:
* [Latent ODE](https://github.com/YuliaRubanova/latent_ode)
* [Latent ODE-RNN](https://github.com/ashysheya/ODE-RNN)
* [ETN-ODE](https://github.com/PengleiGao/ETN-ODE)
* [EgPDE-Net](https://github.com/PengleiGao/EgPDE-net)

![RMSE](https://github.com/Dortp68/ODE-Transformer/blob/main/images/RMSE.png)
![MAE](https://github.com/Dortp68/ODE-Transformer/blob/main/images/MAE.png)


### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ SML2010
![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/sml2010.png)
### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ ETTH1
![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/ETTH1.png)
### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ ETTH2
![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/ETTH2.png)
### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ Electricity
![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/Electricity1.png)
### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –Ω–∞ —à–∞–≥–µ 1.5
![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/timestep_1.5.png)
### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –Ω–∞ —à–∞–≥–µ 2.5
![](https://github.com/Dortp68/ODE-Transformer/blob/main/images/timestep_2.5.png)

